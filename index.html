<!doctype html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Survei Kepuasan UKS</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.tailwindcss.com"></script>

<style>
body { font-family: 'Nunito', sans-serif; }

.option {
  border: 2px solid #e5e7eb;
  padding: 12px;
  border-radius: 14px;
  cursor: pointer;
  text-align: center;
  transition: all .2s ease;
  background: #fff;
}
.option:hover { border-color: #22c55e; }
.option.active {
  background: #dcfce7;
  border-color: #16a34a;
  color: #166534;
  font-weight: 700;
  transform: scale(1.03);
}
.hidden { display:none; }
</style>
</head>

<body class="bg-gradient-to-br from-green-50 via-blue-50 to-lime-50 min-h-screen">

<div class="max-w-xl mx-auto p-6">

<!-- ================= HOME ================= -->
<section id="home">
  <h1 class="text-3xl font-extrabold text-center text-green-700">
    Survei Kepuasan Layanan UKS
  </h1>
  <p class="text-center font-semibold text-blue-700 mb-6">
    MTs Negeri 9 Bantul
  </p>

  <div class="bg-white rounded-3xl shadow-xl p-6 text-center">
    <p class="font-bold text-lg">ğŸ“Š Kepuasan Layanan UKS Saat Ini</p>
    <div class="text-5xl font-extrabold text-green-600 my-3">
      <span id="avgScore">0</span>/100
    </div>

    <p id="statusText" class="mt-3 bg-orange-100 text-orange-700 px-3 py-2 rounded-full">
      Dalam proses peningkatan layanan.
    </p>

    <div class="mt-6 text-left">
      <p class="font-bold mb-2">ğŸ‘¥ Responden</p>
      <div class="grid grid-cols-2 gap-2 text-sm">
        <div>Guru: <span id="guru">0</span></div>
        <div>Pegawai: <span id="pegawai">0</span></div>
        <div>Siswa Kelas VII: <span id="vii">0</span></div>
        <div>Siswa Kelas VIII: <span id="viii">0</span></div>
        <div>Siswa Kelas IX: <span id="ix">0</span></div>
      </div>
    </div>

    <button onclick="go('form')" class="mt-6 w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-xl font-bold">
      ğŸ¥ Mulai Survei
    </button>
  </div>
</section>

<!-- ================= FORM ================= -->
<section id="form" class="hidden">
  <div class="bg-white rounded-3xl shadow-xl p-6">

    <h2 class="text-2xl font-extrabold text-center text-green-700 mb-6">
      ğŸ“‹ Data Responden
    </h2>

    <input id="nama" type="text" placeholder="Nama (opsional)"
      class="w-full border-2 rounded-xl p-3 mb-2">

    <p class="text-sm text-gray-500 mb-6">
      Digunakan hanya untuk dokumentasi internal madrasah.
    </p>

    <p class="font-bold mb-2">Status Anda:</p>
    <div class="grid grid-cols-3 gap-3 mb-6" id="statusGroup">
      <div class="option" data-value="Guru">ğŸ‘¨â€ğŸ« Guru</div>
      <div class="option" data-value="Pegawai">ğŸ‘” Pegawai</div>
      <div class="option" data-value="Siswa">ğŸ‘¨â€ğŸ“ Siswa</div>
    </div>

    <div id="kelasSection" class="hidden">
      <p class="font-bold mb-2">Kelas:</p>
      <div class="grid grid-cols-3 gap-3 mb-6" id="kelasGroup">
        <div class="option" data-value="VII">VII</div>
        <div class="option" data-value="VIII">VIII</div>
        <div class="option" data-value="IX">IX</div>
      </div>
    </div>

    <button onclick="go('survey')" class="w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-xl font-bold">
      Lanjutkan â†’
    </button>
  </div>
</section>

<!-- ================= SURVEY ================= -->
<section id="survey" class="hidden">
  <div class="bg-white rounded-3xl shadow-xl p-6">

    <h2 class="text-xl font-extrabold text-green-700 mb-4">
      ğŸ“ Penilaian Layanan UKS
    </h2>

    <p class="mb-3 font-semibold">Pelayanan UKS mudah diakses</p>
    <div class="grid grid-cols-5 gap-2 mb-6" id="likert">
      <div class="option" data-score="20">1</div>
      <div class="option" data-score="40">2</div>
      <div class="option" data-score="60">3</div>
      <div class="option" data-score="80">4</div>
      <div class="option" data-score="100">5</div>
    </div>

    <button onclick="submitSurvey()" class="w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-xl font-bold">
      Kirim Survei
    </button>
  </div>
</section>

</div>

<script>
let status=null, kelas=null, score=0;

/* ===== NAV ===== */
function go(id){
  ['home','form','survey'].forEach(x=>document.getElementById(x).classList.add('hidden'));
  document.getElementById(id).classList.remove('hidden');
}

/* ===== STORAGE ===== */
function load(){ return JSON.parse(localStorage.getItem('uks')||'[]'); }
function save(d){ localStorage.setItem('uks',JSON.stringify(d)); }

/* ===== HOME UPDATE ===== */
function updateHome(){
  const d=load();
  if(!d.length)return;
  const avg=Math.round(d.reduce((a,b)=>a+b.score,0)/d.length);
  avgScore.textContent=avg;
  statusText.textContent=avg>=80?'âœ“ Target minimal kepuasan (80) telah tercapai.':'Dalam proses peningkatan layanan.';
  statusText.className=avg>=80?
    'mt-3 bg-green-100 text-green-700 px-3 py-2 rounded-full':
    'mt-3 bg-orange-100 text-orange-700 px-3 py-2 rounded-full';

  guru.textContent=pegawai.textContent=vii.textContent=viii.textContent=ix.textContent=0;
  d.forEach(x=>{
    if(x.role==='Guru')guru.textContent++;
    if(x.role==='Pegawai')pegawai.textContent++;
    if(x.role==='Siswa'){
      if(x.kelas==='VII')vii.textContent++;
      if(x.kelas==='VIII')viii.textContent++;
      if(x.kelas==='IX')ix.textContent++;
    }
  });
}
updateHome();

/* ===== HIGHLIGHT ===== */
function activate(group,el){
  document.querySelectorAll(`#${group} .option`).forEach(x=>x.classList.remove('active'));
  el.classList.add('active');
}

/* STATUS */
statusGroup.querySelectorAll('.option').forEach(b=>{
  b.onclick=()=>{
    activate('statusGroup',b);
    status=b.dataset.value;
    kelasSection.classList.toggle('hidden',status!=='Siswa');
  }
});

/* KELAS */
kelasGroup.querySelectorAll('.option').forEach(b=>{
  b.onclick=()=>{
    activate('kelasGroup',b);
    kelas=b.dataset.value;
  }
});

/* LIKERT */
likert.querySelectorAll('.option').forEach(b=>{
  b.onclick=()=>{
    activate('likert',b);
    score=Number(b.dataset.score);
  }
});

/* SUBMIT */
function submitSurvey(){
  if(!status||!score||(status==='Siswa'&&!kelas)){
    alert('Lengkapi isian.');
    return;
  }
  const d=load();
  d.push({role:status,kelas:kelas,score});
  save(d);
  resetAll();
  updateHome();
  go('home');
}

function resetAll(){
  status=kelas=score=null;
  document.querySelectorAll('.option').forEach(x=>x.classList.remove('active'));
  nama.value='';
  kelasSection.classList.add('hidden');
}
</script>

</body>
</html>
